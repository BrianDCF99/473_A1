
### MUTANT M01
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..16c5b702 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -179,7 +179,7 @@ inline std::vector<Value *> parallel_prefix_deletion_masks(KernelBuilder & b, co
     Value * m = b.simd_not(del_mask);
     Value * mk = b.simd_slli(fw, del_mask, 1);
     std::vector<Value *> move_masks;
-    for (unsigned shift = 1; shift < fw; shift *= 2) {
+    for (unsigned shift = 2; shift < fw; shift *= 2) {
         Value * mp = mk;
         for (unsigned lookright = 1; lookright < fw; lookright *= 2) {
             mp = b.simd_xor(mp, b.simd_slli(fw, mp, lookright));

### MUTANT M02
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..77df6e25 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -179,7 +179,7 @@ inline std::vector<Value *> parallel_prefix_deletion_masks(KernelBuilder & b, co
     Value * m = b.simd_not(del_mask);
     Value * mk = b.simd_slli(fw, del_mask, 1);
     std::vector<Value *> move_masks;
-    for (unsigned shift = 1; shift < fw; shift *= 2) {
+    for (unsigned shift = 1; shift > fw; shift *= 2) {
         Value * mp = mk;
         for (unsigned lookright = 1; lookright < fw; lookright *= 2) {
             mp = b.simd_xor(mp, b.simd_slli(fw, mp, lookright));

### MUTANT M03
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..aa9e627e 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -181,7 +181,7 @@ inline std::vector<Value *> parallel_prefix_deletion_masks(KernelBuilder & b, co
     std::vector<Value *> move_masks;
     for (unsigned shift = 1; shift < fw; shift *= 2) {
         Value * mp = mk;
-        for (unsigned lookright = 1; lookright < fw; lookright *= 2) {
+        for (unsigned lookright = 1; lookright < fw; lookright += 2) {
             mp = b.simd_xor(mp, b.simd_slli(fw, mp, lookright));
         }
         Value * mv = b.simd_and(mp, m);



### MUTANT M04
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..26a5a0af 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -194,7 +194,7 @@ inline std::vector<Value *> parallel_prefix_deletion_masks(KernelBuilder & b, co
 
 inline Value * apply_parallel_prefix_deletion(KernelBuilder & b, const unsigned fw, Value * del_mask, const std::vector<Value *> & mv, Value * strm) {
     Value * s = b.simd_and(strm, b.simd_not(del_mask));
-    for (unsigned i = 0; i < mv.size(); i++) {
+    for (unsigned i = 1; i < mv.size(); i++) {
         unsigned shift = 1 << i;
         Value * t = b.simd_and(s, mv[i]);
         s = b.simd_or(b.simd_xor(s, t), b.simd_srli(fw, t, shift));

### MUTANT M05
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..c04d9c4c 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -194,7 +194,7 @@ inline std::vector<Value *> parallel_prefix_deletion_masks(KernelBuilder & b, co
 
 inline Value * apply_parallel_prefix_deletion(KernelBuilder & b, const unsigned fw, Value * del_mask, const std::vector<Value *> & mv, Value * strm) {
     Value * s = b.simd_and(strm, b.simd_not(del_mask));
-    for (unsigned i = 0; i < mv.size(); i++) {
+    for (unsigned i = 0; i > mv.size(); i++) {
         unsigned shift = 1 << i;
         Value * t = b.simd_and(s, mv[i]);
         s = b.simd_or(b.simd_xor(s, t), b.simd_srli(fw, t, shift));

### MUTANT M06
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..ca241ddb 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -194,7 +194,7 @@ inline std::vector<Value *> parallel_prefix_deletion_masks(KernelBuilder & b, co
 
 inline Value * apply_parallel_prefix_deletion(KernelBuilder & b, const unsigned fw, Value * del_mask, const std::vector<Value *> & mv, Value * strm) {
     Value * s = b.simd_and(strm, b.simd_not(del_mask));
-    for (unsigned i = 0; i < mv.size(); i++) {
+    for (unsigned i = 0; i < mv.size(); i--) {
         unsigned shift = 1 << i;
         Value * t = b.simd_and(s, mv[i]);
         s = b.simd_or(b.simd_xor(s, t), b.simd_srli(fw, t, shift));

### MUTANT M07
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..29719d07 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -195,7 +195,7 @@ inline std::vector<Value *> parallel_prefix_deletion_masks(KernelBuilder & b, co
 inline Value * apply_parallel_prefix_deletion(KernelBuilder & b, const unsigned fw, Value * del_mask, const std::vector<Value *> & mv, Value * strm) {
     Value * s = b.simd_and(strm, b.simd_not(del_mask));
     for (unsigned i = 0; i < mv.size(); i++) {
-        unsigned shift = 1 << i;
+        unsigned shift = 1 >> i;
         Value * t = b.simd_and(s, mv[i]);
         s = b.simd_or(b.simd_xor(s, t), b.simd_srli(fw, t, shift));
     }

### MUTANT M08
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..9a433a59 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -209,7 +209,7 @@ inline Value * apply_parallel_prefix_deletion(KernelBuilder & b, const unsigned
 void DeletionKernel::generateDoBlockMethod(KernelBuilder & b) {
     Value * delMask = b.loadInputStreamBlock("delMaskSet", b.getInt32(0));
     const auto move_masks = parallel_prefix_deletion_masks(b, mDeletionFieldWidth, delMask);
-    for (unsigned j = 0; j < mStreamCount; ++j) {
+    for (unsigned j = 1; j < mStreamCount; ++j) {
         Value * input = b.loadInputStreamBlock("inputStreamSet", b.getInt32(j));
         Value * output = apply_parallel_prefix_deletion(b, mDeletionFieldWidth, delMask, move_masks, input);
         b.storeOutputStreamBlock("outputStreamSet", b.getInt32(j), output);

### MUTANT M09
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..0d35eab9 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -224,7 +224,7 @@ void DeletionKernel::generateFinalBlockMethod(KernelBuilder & b, Value * remaini
     Value * EOF_del = b.bitCast(b.CreateShl(Constant::getAllOnesValue(vecTy), remaining));
     Value * delMask = b.CreateOr(EOF_del, b.loadInputStreamBlock("delMaskSet", b.getInt32(0)));
     const auto move_masks = parallel_prefix_deletion_masks(b, mDeletionFieldWidth, delMask);
-    for (unsigned j = 0; j < mStreamCount; ++j) {
+    for (unsigned j = 0; j > mStreamCount; ++j) {
         Value * input = b.loadInputStreamBlock("inputStreamSet", b.getInt32(j));
         Value * output = apply_parallel_prefix_deletion(b, mDeletionFieldWidth, delMask, move_masks, input);
         b.storeOutputStreamBlock("outputStreamSet", b.getInt32(j), output);

### MUTANT M10
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..b7d86703 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -224,7 +224,7 @@ void DeletionKernel::generateFinalBlockMethod(KernelBuilder & b, Value * remaini
     Value * EOF_del = b.bitCast(b.CreateShl(Constant::getAllOnesValue(vecTy), remaining));
     Value * delMask = b.CreateOr(EOF_del, b.loadInputStreamBlock("delMaskSet", b.getInt32(0)));
     const auto move_masks = parallel_prefix_deletion_masks(b, mDeletionFieldWidth, delMask);
-    for (unsigned j = 0; j < mStreamCount; ++j) {
+    for (unsigned j = 0; j < mStreamCount; --j) {
         Value * input = b.loadInputStreamBlock("inputStreamSet", b.getInt32(j));
         Value * output = apply_parallel_prefix_deletion(b, mDeletionFieldWidth, delMask, move_masks, input);
         b.storeOutputStreamBlock("outputStreamSet", b.getInt32(j), output);

### MUTANT M11
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..29a761d2 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -266,7 +266,7 @@ void FieldCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Value
         for (unsigned i = 0; i < fieldsPerBlock; i++) {
             mask[i] = b.CreateExtractElement(extractionMask, b.getInt32(i));
         }
-        for (unsigned j = 0; j < input.size(); ++j) {
+        for (unsigned j = 0; j =< input.size(); ++j) {
             Value * fieldVec = b.fwCast(mFW, input[j]);
             Value * output = UndefValue::get(extractionMask->getType());
             for (unsigned i = 0; i < fieldsPerBlock; i++) {

### MUTANT M12
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..403736fa 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -271,7 +271,7 @@ void FieldCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Value
             Value * output = UndefValue::get(extractionMask->getType());
             for (unsigned i = 0; i < fieldsPerBlock; i++) {
                 Value * field = b.CreateExtractElement(fieldVec, b.getInt32(i));
-                Value * compressed = b.CreatePextract(field, mask[i]);
+                Value * compressed = b.CreatePextract(field, mask[j]);
                 // Pextract is returning 32-bit integers but fieldTy is 16 bit?
                 compressed = b.CreateZExtOrTrunc(compressed, fieldTy);
                 output = b.CreateInsertElement(output, compressed, b.getInt32(i));

### MUTANT M13
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..3ae5da3d 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -263,7 +263,7 @@ void FieldCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Value
         const unsigned fieldsPerBlock = b.getBitBlockWidth()/mFW;
         Value * extractionMask = b.fwCast(mFW, maskVec[0]);
         std::vector<Value *> mask(fieldsPerBlock);
-        for (unsigned i = 0; i < fieldsPerBlock; i++) {
+        for (unsigned i = 0; i < fieldsPerBlock; i--) {
             mask[i] = b.CreateExtractElement(extractionMask, b.getInt32(i));
         }
         for (unsigned j = 0; j < input.size(); ++j) {

### MUTANT M14
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..91511810 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -281,7 +281,7 @@ void FieldCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Value
         }
     } else {
         std::vector<Value *> output = b.simd_pext(mFW, input, maskVec[0]);
-        for (unsigned j = 0; j < output.size(); ++j) {
+        for (unsigned j = 1; j < output.size(); ++j) {
             b.storeOutputStreamBlock("outputStreamSet", b.getInt32(j), blockOffsetPhi, output[j]);
         }
     }

### MUTANT M15
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..c4776e69 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -401,7 +401,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     Constant * oneSplat = b.getSplat(numFields, ConstantInt::get(fwTy, 1));
     Constant * CFW = ConstantInt::get(fwTy, mFW);
     Constant * numFieldConst = ConstantInt::get(fwTy, numFields);
-    Constant * fwMaskSplat = b.getSplat(numFields, ConstantInt::get(fwTy, mFW - 1));
+    Constant * fwMaskSplat = b.getSplat(numFields, ConstantInt::get(fwTy, mFW + 1));
     Constant * intSequence = b.getConstantVectorSequence(mFW, 0, numFields - 1, 1);
 
     Constant * BLOCK_WIDTH = ConstantInt::get(fwTy, b.getBitBlockWidth());

### MUTANT M16
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..e0017408 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -402,7 +402,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     Constant * CFW = ConstantInt::get(fwTy, mFW);
     Constant * numFieldConst = ConstantInt::get(fwTy, numFields);
     Constant * fwMaskSplat = b.getSplat(numFields, ConstantInt::get(fwTy, mFW - 1));
-    Constant * intSequence = b.getConstantVectorSequence(mFW, 0, numFields - 1, 1);
+    Constant * intSequence = b.getConstantVectorSequence(mFW, 0, numFields + 1, 1);
 
     Constant * BLOCK_WIDTH = ConstantInt::get(fwTy, b.getBitBlockWidth());
     Constant * BLOCK_MASK = ConstantInt::get(fwTy, b.getBitBlockWidth() - 1);

### MUTANT M17
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..4e467605 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -405,7 +405,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     Constant * intSequence = b.getConstantVectorSequence(mFW, 0, numFields - 1, 1);
 
     Constant * BLOCK_WIDTH = ConstantInt::get(fwTy, b.getBitBlockWidth());
-    Constant * BLOCK_MASK = ConstantInt::get(fwTy, b.getBitBlockWidth() - 1);
+    Constant * BLOCK_MASK = ConstantInt::get(fwTy, b.getBitBlockWidth() + 1);
 
     BasicBlock * const segmentLoop = b.CreateBasicBlock("segmentLoop");
     BasicBlock * const segmentDone = b.CreateBasicBlock("segmentDone");

### MUTANT M18
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..0849b893 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -415,7 +415,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     Constant * const ZERO = ConstantInt::get(sizeTy, 0);
     Constant * const ONE = ConstantInt::get(sizeTy, 1);
     Value * numOfBlocks = numOfStrides;
-    if (getStride() != b.getBitBlockWidth()) {
+    if (getStride() == b.getBitBlockWidth()) {
         numOfBlocks = b.CreateShl(numOfStrides, b.getSize(floor_log2(getStride()/b.getBitBlockWidth())));
     }
 

### MUTANT M19
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..ff84cc88 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -416,7 +416,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     Constant * const ONE = ConstantInt::get(sizeTy, 1);
     Value * numOfBlocks = numOfStrides;
     if (getStride() != b.getBitBlockWidth()) {
-        numOfBlocks = b.CreateShl(numOfStrides, b.getSize(floor_log2(getStride()/b.getBitBlockWidth())));
+        numOfBlocks = b.CreateShl(numOfStrides, b.getSize(floor_log2(getStride()*b.getBitBlockWidth())));
     }
 
     Value * const produced = b.getProducedItemCount("compressedOutput");

### MUTANT M20
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..30ebd8e9 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -472,7 +472,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
         // For each field determine the (partial) sum popcount of all fields up to and
         // including the current field.
         Value * const partialSum = b.hsimd_partial_sum(mFW, fieldPopCounts);
-        Value * const newPendingItems = b.mvmd_extract(mFW, partialSum, numFields - 1);
+        Value * const newPendingItems = b.mvmd_extract(mFW, partialSum, numFields - 2);
         //
         // Now determine for each source field the output offset of the first bit.
         // Note that this depends on the number of pending bits.

### MUTANT M21
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..5cd2d474 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -504,7 +504,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
         assert (fieldNo->getType() == oneSplat->getType());
         // Now move bits back and combine to produce consecutive field numbers.
         Value * firstFieldNoSplat = b.simd_fill(mFW, b.mvmd_extract(mFW, fieldNo, 0));
-        assert (firstFieldNoSplat->getType() == fieldNo->getType());
+        assert (firstFieldNoSplat->getType() != fieldNo->getType());
         Value * finalFieldNo = b.CreateAdd(firstFieldNoSplat, intSequence);
         assert (finalFieldNo->getType() == fieldNo->getType());
         for (unsigned step = 0; step < fieldMovementSteps; step++) {

### MUTANT M22
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..47dd336b 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -506,7 +506,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
         Value * firstFieldNoSplat = b.simd_fill(mFW, b.mvmd_extract(mFW, fieldNo, 0));
         assert (firstFieldNoSplat->getType() == fieldNo->getType());
         Value * finalFieldNo = b.CreateAdd(firstFieldNoSplat, intSequence);
-        assert (finalFieldNo->getType() == fieldNo->getType());
+        assert (finalFieldNo->getType() != fieldNo->getType());
         for (unsigned step = 0; step < fieldMovementSteps; step++) {
             unsigned mov = 1UL << step;
             assert (finalFieldNo->getType() == fieldNo->getType());

### MUTANT M23
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..a67b71d6 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -507,7 +507,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
         assert (firstFieldNoSplat->getType() == fieldNo->getType());
         Value * finalFieldNo = b.CreateAdd(firstFieldNoSplat, intSequence);
         assert (finalFieldNo->getType() == fieldNo->getType());
-        for (unsigned step = 0; step < fieldMovementSteps; step++) {
+        for (unsigned step = 0; step >= fieldMovementSteps; step++) {
             unsigned mov = 1UL << step;
             assert (finalFieldNo->getType() == fieldNo->getType());
             Value * fieldMovement = b.CreateSub(finalFieldNo, fieldNo);

### MUTANT M24
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..3b056b23 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -508,7 +508,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
         Value * finalFieldNo = b.CreateAdd(firstFieldNoSplat, intSequence);
         assert (finalFieldNo->getType() == fieldNo->getType());
         for (unsigned step = 0; step < fieldMovementSteps; step++) {
-            unsigned mov = 1UL << step;
+            unsigned mov = 1UL >> step;
             assert (finalFieldNo->getType() == fieldNo->getType());
             Value * fieldMovement = b.CreateSub(finalFieldNo, fieldNo);
             Value * movSplat = b.simd_fill(mFW, b.getIntN(mFW, mov));

### MUTANT M25
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..fee7fdd6 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -548,7 +548,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
         outputOffset[blk+1] = b.CreateSelect(doesFit[blk], outputOffset[blk], nextOutputOffset);
         // Update pending data, based on whether all data fits within the current block.
     }
-    for (unsigned blk = 0; blk < strideBlocks; blk++) {
+    for (unsigned blk = 1; blk < strideBlocks; blk++) {
         // Now process the input data block of each stream in the input stream set.
         //
         // First load all the stream set blocks and the pending data.

### MUTANT M26
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..b2ffa61f 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -573,7 +573,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
         }
         // Now compress the data fields, eliminating duplicate field numbers.
         for (unsigned step = 0; step < fieldMovementSteps; step++) {
-            unsigned mov = 1 << step;
+            unsigned mov = 1 >> step;
             for (unsigned i = 0; i < mStreamCount; i++) {
                 Value * unmoved = b.simd_and(outputFields[i], combine[blk][step]);
                 Value * data_to_move = b.simd_and(outputFields[i], fieldsToMove[blk][step]);

### MUTANT M27
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..4c67db1a 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -577,7 +577,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
             for (unsigned i = 0; i < mStreamCount; i++) {
                 Value * unmoved = b.simd_and(outputFields[i], combine[blk][step]);
                 Value * data_to_move = b.simd_and(outputFields[i], fieldsToMove[blk][step]);
-                Value * fields_back = b.mvmd_srli(mFW, data_to_move, mov);
+                Value * fields_back = b.mvmd_srli(blk, data_to_move, mov);
                 Value * cleared = b.simd_xor(outputFields[i], data_to_move);
                 outputFields[i] = b.simd_or(fields_back, b.simd_or(unmoved, cleared));
             }

### MUTANT M28
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..558f87e3 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -600,7 +600,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
         for (unsigned i = 0; i < mStreamCount; i++) {
             b.storeOutputStreamBlock("compressedOutput", b.getInt32(i), outputOffset[blk], pendingOutput[i]);
         }
-        for (unsigned i = 0; i < mStreamCount; i++) {
+        for (unsigned i = 0; i > mStreamCount; i++) {
             pendingData[i] = b.bitCast(b.CreateSelect(doesFit[blk], pendingOutput[i], outputFields[i]));
         }
     }

### MUTANT M29
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..58b7062b 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -644,7 +644,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
 void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Value * const numOfBlocks) {
     IntegerType * const fwTy = b.getIntNTy(mFW);
     IntegerType * const sizeTy = b.getSizeTy();
-    const unsigned numFields = b.getBitBlockWidth() / mFW;
+    const unsigned numFields = b.getBitBlockWidth() * mFW;
     Constant * zeroSplat = Constant::getNullValue(b.fwVectorType(mFW));
     Constant * oneSplat = b.getSplat(numFields, ConstantInt::get(fwTy, 1));
     Constant * CFW = ConstantInt::get(fwTy, mFW);

### MUTANT M30
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..3a5f700a 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -650,7 +650,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     Constant * CFW = ConstantInt::get(fwTy, mFW);
     Constant * fwSplat = b.getSplat(numFields, CFW);
     Constant * numFieldConst = ConstantInt::get(fwTy, numFields);
-    Constant * fwMaskSplat = b.getSplat(numFields, ConstantInt::get(fwTy, mFW - 1));
+    Constant * fwMaskSplat = b.getSplat(numFields, ConstantInt::get(fwTy, mFW + 1));
     Constant * BLOCK_WIDTH = ConstantInt::get(fwTy, b.getBitBlockWidth());
     Constant * BLOCK_MASK = ConstantInt::get(fwTy, b.getBitBlockWidth() - 1);
 


### MUTANT M31
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..97f966c7 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -652,7 +652,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     Constant * numFieldConst = ConstantInt::get(fwTy, numFields);
     Constant * fwMaskSplat = b.getSplat(numFields, ConstantInt::get(fwTy, mFW - 1));
     Constant * BLOCK_WIDTH = ConstantInt::get(fwTy, b.getBitBlockWidth());
-    Constant * BLOCK_MASK = ConstantInt::get(fwTy, b.getBitBlockWidth() - 1);
+    Constant * BLOCK_MASK = ConstantInt::get(fwTy, b.getBitBlockWidth() + 1);
 
     ConstantInt * const sz_ZERO = ConstantInt::get(sizeTy, 0);
     ConstantInt * const sz_ONE = ConstantInt::get(sizeTy, 1);

### MUTANT M32
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..e9bc9bca 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -650,7 +650,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     Constant * CFW = ConstantInt::get(fwTy, mFW);
     Constant * fwSplat = b.getSplat(numFields, CFW);
     Constant * numFieldConst = ConstantInt::get(fwTy, numFields);
-    Constant * fwMaskSplat = b.getSplat(numFields, ConstantInt::get(fwTy, mFW - 1));
+    Constant * fwMaskSplat = b.getSplat(numFields, ConstantInt::get(fwTy, mFW - 2));
     Constant * BLOCK_WIDTH = ConstantInt::get(fwTy, b.getBitBlockWidth());
     Constant * BLOCK_MASK = ConstantInt::get(fwTy, b.getBitBlockWidth() - 1);
 

### MUTANT M33
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..de70f535 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -652,7 +652,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     Constant * numFieldConst = ConstantInt::get(fwTy, numFields);
     Constant * fwMaskSplat = b.getSplat(numFields, ConstantInt::get(fwTy, mFW - 1));
     Constant * BLOCK_WIDTH = ConstantInt::get(fwTy, b.getBitBlockWidth());
-    Constant * BLOCK_MASK = ConstantInt::get(fwTy, b.getBitBlockWidth() - 1);
+    Constant * BLOCK_MASK = ConstantInt::get(fwTy, b.getBitBlockWidth() - 2);
 
     ConstantInt * const sz_ZERO = ConstantInt::get(sizeTy, 0);
     ConstantInt * const sz_ONE = ConstantInt::get(sizeTy, 1);

### MUTANT M34
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..19e5c746 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -960,7 +960,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 , mSwizzleSetCount(ceil_udiv(mStreamCount, mSwizzleFactor))
 , mPEXTWidth(PEXTWidth) {
 
-    assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
+    assert((mPEXTWidth > 0) || ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
     assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);

### MUTANT M35
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..1346f833 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -960,7 +960,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 , mSwizzleSetCount(ceil_udiv(mStreamCount, mSwizzleFactor))
 , mPEXTWidth(PEXTWidth) {
 
-    assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
+    assert((mPEXTWidth >= 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
     assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);

### MUTANT M36
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..58759679 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -960,7 +960,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 , mSwizzleSetCount(ceil_udiv(mStreamCount, mSwizzleFactor))
 , mPEXTWidth(PEXTWidth) {
 
-    assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
+    assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth + 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
     assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);

### MUTANT M37
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..5c209ca3 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -960,7 +960,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 , mSwizzleSetCount(ceil_udiv(mStreamCount, mSwizzleFactor))
 , mPEXTWidth(PEXTWidth) {
 
-    assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
+    assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) != 0) && "mDelCountFieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
     assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);

### MUTANT M38
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..e6349d00 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -960,7 +960,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 , mSwizzleSetCount(ceil_udiv(mStreamCount, mSwizzleFactor))
 , mPEXTWidth(PEXTWidth) {
 
-    assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
+    assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) || "mDelCountFieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
     assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);

### MUTANT M39
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..9057b9cd 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -961,7 +961,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 , mPEXTWidth(PEXTWidth) {
 
     assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
-    assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
+    assert(mSwizzleFactor >= 1 && "mDelCountFieldWidth must be less than the block width");
     assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);
     assert (outputStreamSets.size() == mSwizzleSetCount);

### MUTANT M40
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..68dfaa89 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -961,7 +961,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 , mPEXTWidth(PEXTWidth) {
 
     assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
-    assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
+    assert(mSwizzleFactor > 1 || "mDelCountFieldWidth must be less than the block width");
     assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);
     assert (outputStreamSets.size() == mSwizzleSetCount);

### MUTANT M41
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..e809b361 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -962,7 +962,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 
     assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
-    assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
+    assert((mPEXTWidth != 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);
     assert (outputStreamSets.size() == mSwizzleSetCount);
     assert (outputStreamSets[0]->getNumElements() == mSwizzleFactor);

### MUTANT M42
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..f8644e2a 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -962,7 +962,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 
     assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
-    assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
+    assert((mPEXTWidth == 64 && mPEXTWidth == 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);
     assert (outputStreamSets.size() == mSwizzleSetCount);
     assert (outputStreamSets[0]->getNumElements() == mSwizzleFactor);

### MUTANT M43
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..ed0d215c 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -962,7 +962,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
 
     assert((mPEXTWidth > 0) && ((mPEXTWidth & (mPEXTWidth - 1)) == 0) && "mDelCountFieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "mDelCountFieldWidth must be less than the block width");
-    assert((mPEXTWidth == 64 || mPEXTWidth == 32) && "PEXT width must be 32 or 64");
+    assert((mPEXTWidth == 64 || mPEXTWidth != 32) && "PEXT width must be 32 or 64");
     assert (mSwizzleSetCount);
     assert (outputStreamSets.size() == mSwizzleSetCount);
     assert (outputStreamSets[0]->getNumElements() == mSwizzleFactor);

### MUTANT M44
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..076ceb3c 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -968,7 +968,7 @@ SwizzledDeleteByPEXTkernel::SwizzledDeleteByPEXTkernel(LLVMTypeSystemInterface &
     assert (outputStreamSets[0]->getNumElements() == mSwizzleFactor);
 
     addInternalScalar(ts.getBitBlockType(), "pendingSwizzleData0");
-    for (unsigned i = 1; i < outputStreamSets.size(); ++i) {
+    for (unsigned i = 2; i < outputStreamSets.size(); ++i) {
         assert (outputStreamSets[i]->getNumElements() == mSwizzleFactor);
         addInternalScalar(ts.getBitBlockType(), "pendingSwizzleData" + std::to_string(i));
     }

### MUTANT M45
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..766840e8 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -988,7 +988,7 @@ void SwizzledDeleteByPEXTkernel::generateMultiBlockLogic(KernelBuilder & b, llvm
     ConstantInt * const PEXT_WIDTH_MASK = b.getSize(mPEXTWidth - 1);
 
     Value * numOfBlocks = numOfStrides;
-    if (getStride() != b.getBitBlockWidth()) {
+    if (getStride() == b.getBitBlockWidth()) {
         numOfBlocks = b.CreateShl(numOfStrides, b.getSize(floor_log2(getStride()/b.getBitBlockWidth())));
     }
     // All output groups have the same count.

### MUTANT M46
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..6269cd56 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -989,7 +989,7 @@ void SwizzledDeleteByPEXTkernel::generateMultiBlockLogic(KernelBuilder & b, llvm
 
     Value * numOfBlocks = numOfStrides;
     if (getStride() != b.getBitBlockWidth()) {
-        numOfBlocks = b.CreateShl(numOfStrides, b.getSize(floor_log2(getStride()/b.getBitBlockWidth())));
+        numOfBlocks = b.CreateShl(numOfStrides, b.getSize(floor_log2(getStride()*b.getBitBlockWidth())));
     }
     // All output groups have the same count.
     Value * const baseOutputProduced = b.getProducedItemCount(getOutputStreamSetBinding(0).getName());

### MUTANT M47
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..7446bdfb 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -981,7 +981,7 @@ void SwizzledDeleteByPEXTkernel::generateMultiBlockLogic(KernelBuilder & b, llvm
     BasicBlock * const beginLoop = b.CreateBasicBlock("beginLoop");
 
     ConstantInt * const ZERO = b.getSize(0);
-    ConstantInt * const BLOCK_WIDTH_MASK = b.getSize(b.getBitBlockWidth() - 1);
+    ConstantInt * const BLOCK_WIDTH_MASK = b.getSize(b.getBitBlockWidth() - 2);
     ConstantInt * const PEXT_WIDTH = b.getSize(mPEXTWidth);
     ConstantInt * const LOG_2_PEXT_WIDTH = b.getSize(floor_log2(mPEXTWidth));
     ConstantInt * const LOG_2_SWIZZLE_FACTOR = b.getSize(floor_log2(mSwizzleFactor));

### MUTANT M48
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..16556e76 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -985,7 +985,7 @@ void SwizzledDeleteByPEXTkernel::generateMultiBlockLogic(KernelBuilder & b, llvm
     ConstantInt * const PEXT_WIDTH = b.getSize(mPEXTWidth);
     ConstantInt * const LOG_2_PEXT_WIDTH = b.getSize(floor_log2(mPEXTWidth));
     ConstantInt * const LOG_2_SWIZZLE_FACTOR = b.getSize(floor_log2(mSwizzleFactor));
-    ConstantInt * const PEXT_WIDTH_MASK = b.getSize(mPEXTWidth - 1);
+    ConstantInt * const PEXT_WIDTH_MASK = b.getSize(mPEXTWidth - 2);
 
     Value * numOfBlocks = numOfStrides;
     if (getStride() != b.getBitBlockWidth()) {

### MUTANT M49
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..577df433 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1008,7 +1008,7 @@ void SwizzledDeleteByPEXTkernel::generateMultiBlockLogic(KernelBuilder & b, llvm
     PHINode * const producedOffsetPhi = b.CreatePHI(numOfBlocks->getType(), 2);
     producedOffsetPhi->addIncoming(baseProducedOffset, entry);
     std::vector<PHINode *> pendingDataPhi(mSwizzleSetCount);
-    for (unsigned i = 0; i < mSwizzleSetCount; i++) {
+    for (unsigned i = 0; i <= mSwizzleSetCount; i++) {
         pendingDataPhi[i] = b.CreatePHI(pendingData[i]->getType(), 2);
         pendingDataPhi[i]->addIncoming(pendingData[i], entry);
         pendingData[i] = pendingDataPhi[i];

### MUTANT M50
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..f1a81deb 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1008,7 +1008,7 @@ void SwizzledDeleteByPEXTkernel::generateMultiBlockLogic(KernelBuilder & b, llvm
     PHINode * const producedOffsetPhi = b.CreatePHI(numOfBlocks->getType(), 2);
     producedOffsetPhi->addIncoming(baseProducedOffset, entry);
     std::vector<PHINode *> pendingDataPhi(mSwizzleSetCount);
-    for (unsigned i = 0; i < mSwizzleSetCount; i++) {
+    for (unsigned i = 1; i < mSwizzleSetCount; i++) {
         pendingDataPhi[i] = b.CreatePHI(pendingData[i]->getType(), 2);
         pendingDataPhi[i]->addIncoming(pendingData[i], entry);
         pendingData[i] = pendingDataPhi[i];

### MUTANT M51
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..385a5bb8 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1248,7 +1248,7 @@ SwizzledBitstreamCompressByCount::SwizzledBitstreamCompressByCount(LLVMTypeSyste
                      {Binding{ts.getStreamSetTy(), "countsPerStride"}}, {}, {}, {}, {})
 , mBitStreamCount(bitStreamCount)
 , mFieldWidth(fieldWidth)
-, mSwizzleFactor(ts.getBitBlockWidth() / fieldWidth)
+, mSwizzleFactor(ts.getBitBlockWidth() * fieldWidth)
 , mSwizzleSetCount((mBitStreamCount + mSwizzleFactor - 1)/mSwizzleFactor) {
     assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) == 0) && "fieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "fieldWidth must be less than the block width");

### MUTANT M52
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..7acaff41 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1249,7 +1249,7 @@ SwizzledBitstreamCompressByCount::SwizzledBitstreamCompressByCount(LLVMTypeSyste
 , mBitStreamCount(bitStreamCount)
 , mFieldWidth(fieldWidth)
 , mSwizzleFactor(ts.getBitBlockWidth() / fieldWidth)
-, mSwizzleSetCount((mBitStreamCount + mSwizzleFactor - 1)/mSwizzleFactor) {
+, mSwizzleSetCount((mBitStreamCount - mSwizzleFactor - 1)/mSwizzleFactor) {
     assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) == 0) && "fieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "fieldWidth must be less than the block width");
     mInputStreamSets.push_back(Binding{ts.getStreamSetTy(mSwizzleFactor, 1), "inputSwizzle0"});

### MUTANT M53
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..e8b03a3c 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1249,7 +1249,7 @@ SwizzledBitstreamCompressByCount::SwizzledBitstreamCompressByCount(LLVMTypeSyste
 , mBitStreamCount(bitStreamCount)
 , mFieldWidth(fieldWidth)
 , mSwizzleFactor(ts.getBitBlockWidth() / fieldWidth)
-, mSwizzleSetCount((mBitStreamCount + mSwizzleFactor - 1)/mSwizzleFactor) {
+, mSwizzleSetCount((mBitStreamCount + mSwizzleFactor + 1)/mSwizzleFactor) {
     assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) == 0) && "fieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "fieldWidth must be less than the block width");
     mInputStreamSets.push_back(Binding{ts.getStreamSetTy(mSwizzleFactor, 1), "inputSwizzle0"});

### MUTANT M54
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..17b15308 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1249,7 +1249,7 @@ SwizzledBitstreamCompressByCount::SwizzledBitstreamCompressByCount(LLVMTypeSyste
 , mBitStreamCount(bitStreamCount)
 , mFieldWidth(fieldWidth)
 , mSwizzleFactor(ts.getBitBlockWidth() / fieldWidth)
-, mSwizzleSetCount((mBitStreamCount + mSwizzleFactor - 1)/mSwizzleFactor) {
+, mSwizzleSetCount((mBitStreamCount + mSwizzleFactor - 2)/mSwizzleFactor) {
     assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) == 0) && "fieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "fieldWidth must be less than the block width");
     mInputStreamSets.push_back(Binding{ts.getStreamSetTy(mSwizzleFactor, 1), "inputSwizzle0"});

### MUTANT M55
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..68c65ba0 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1250,7 +1250,7 @@ SwizzledBitstreamCompressByCount::SwizzledBitstreamCompressByCount(LLVMTypeSyste
 , mFieldWidth(fieldWidth)
 , mSwizzleFactor(ts.getBitBlockWidth() / fieldWidth)
 , mSwizzleSetCount((mBitStreamCount + mSwizzleFactor - 1)/mSwizzleFactor) {
-    assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) == 0) && "fieldWidth must be a power of 2");
+    assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) != 0) && "fieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "fieldWidth must be less than the block width");
     mInputStreamSets.push_back(Binding{ts.getStreamSetTy(mSwizzleFactor, 1), "inputSwizzle0"});
     mOutputStreamSets.push_back(Binding{ts.getStreamSetTy(mSwizzleFactor, 1), "outputSwizzle0", BoundedRate(0, 1)});

### MUTANT M56
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..dae84ae4 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1250,7 +1250,7 @@ SwizzledBitstreamCompressByCount::SwizzledBitstreamCompressByCount(LLVMTypeSyste
 , mFieldWidth(fieldWidth)
 , mSwizzleFactor(ts.getBitBlockWidth() / fieldWidth)
 , mSwizzleSetCount((mBitStreamCount + mSwizzleFactor - 1)/mSwizzleFactor) {
-    assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) == 0) && "fieldWidth must be a power of 2");
+    assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) == 1) && "fieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "fieldWidth must be less than the block width");
     mInputStreamSets.push_back(Binding{ts.getStreamSetTy(mSwizzleFactor, 1), "inputSwizzle0"});
     mOutputStreamSets.push_back(Binding{ts.getStreamSetTy(mSwizzleFactor, 1), "outputSwizzle0", BoundedRate(0, 1)});

### MUTANT M57
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..13194299 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1250,7 +1250,7 @@ SwizzledBitstreamCompressByCount::SwizzledBitstreamCompressByCount(LLVMTypeSyste
 , mFieldWidth(fieldWidth)
 , mSwizzleFactor(ts.getBitBlockWidth() / fieldWidth)
 , mSwizzleSetCount((mBitStreamCount + mSwizzleFactor - 1)/mSwizzleFactor) {
-    assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) == 0) && "fieldWidth must be a power of 2");
+    assert((fieldWidth > 0) && ((fieldWidth & (fieldWidth - 1)) == 1) || "fieldWidth must be a power of 2");
     assert(mSwizzleFactor > 1 && "fieldWidth must be less than the block width");
     mInputStreamSets.push_back(Binding{ts.getStreamSetTy(mSwizzleFactor, 1), "inputSwizzle0"});
     mOutputStreamSets.push_back(Binding{ts.getStreamSetTy(mSwizzleFactor, 1), "outputSwizzle0", BoundedRate(0, 1)});

### MUTANT M58
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..3943ab40 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1276,7 +1276,7 @@ void SwizzledBitstreamCompressByCount::generateDoBlockMethod(KernelBuilder & b)
     Constant * outputIndexShift = b.getSize(floor_log2(mFieldWidth));
 
     Value * outputProduced = b.getProducedItemCount("outputSwizzle0"); // All output groups have the same count.
-    Value * producedOffset = b.CreateAnd(outputProduced, blockOffsetMask);
+    Value * producedOffset = b.CreateOr(outputProduced, blockOffsetMask);
     Value * outputIndex = b.CreateLShr(producedOffset, outputIndexShift);
 
     // There may be pending data in the kernel state, for up to mFieldWidth-1 bits per stream.

### MUTANT M59
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..72bb22e5 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1303,7 +1303,7 @@ void SwizzledBitstreamCompressByCount::generateDoBlockMethod(KernelBuilder & b)
         for (unsigned j = 0; j < mSwizzleSetCount; j++) {
             Value * newItems = b.loadInputStreamBlock("inputSwizzle" + std::to_string(j), b.getInt32(i));
             // Combine as many of the new items as possible into the pending group.
-            Value * combinedGroup = b.CreateOr(pendingData[j], b.CreateShl(newItems, fieldWidths));
+            Value * combinedGroup = b.CreateAnd(pendingData[j], b.CreateShl(newItems, fieldWidths));
             // To avoid an unpredictable branch, always store the combined group, whether full or not.
             b.CreateBlockAlignedStore(combinedGroup, b.CreateGEP(blockTy, outputStreamPtr[j], outputIndex));
             // Any items in excess of the space available in the current pending group overflow for the next group.

### MUTANT M60
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..152ff951 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1312,7 +1312,7 @@ void SwizzledBitstreamCompressByCount::generateDoBlockMethod(KernelBuilder & b)
             pendingData[j] = b.CreateSelect(pendingSpaceFilled, overFlowGroup, combinedGroup);
         }
         outputIndex = b.CreateSelect(pendingSpaceFilled, b.CreateAdd(outputIndex, b.getSize(1)), outputIndex);
-        pendingOffset = b.CreateAnd(b.CreateAdd(newItemCount, pendingOffset), b.getSize(mFieldWidth-1));
+        pendingOffset = b.CreateOr(b.CreateAdd(newItemCount, pendingOffset), b.getSize(mFieldWidth-1));
     }
     b.setScalarField("pendingOffset", pendingOffset);
 //    Value * newlyProduced = kb.CreateSub(kb.CreateShl(outputIndex, outputIndexShift), producedOffset);

### MUTANT M61
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..f66c6851 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1312,7 +1312,7 @@ void SwizzledBitstreamCompressByCount::generateDoBlockMethod(KernelBuilder & b)
             pendingData[j] = b.CreateSelect(pendingSpaceFilled, overFlowGroup, combinedGroup);
         }
         outputIndex = b.CreateSelect(pendingSpaceFilled, b.CreateAdd(outputIndex, b.getSize(1)), outputIndex);
-        pendingOffset = b.CreateAnd(b.CreateAdd(newItemCount, pendingOffset), b.getSize(mFieldWidth-1));
+        pendingOffset = b.CreateAnd(b.CreateAdd(newItemCount, pendingOffset), b.getSize(mFieldWidth-2));
     }
     b.setScalarField("pendingOffset", pendingOffset);
 //    Value * newlyProduced = kb.CreateSub(kb.CreateShl(outputIndex, outputIndexShift), producedOffset);

### MUTANT M62
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..0386c7d6 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1325,7 +1325,7 @@ void SwizzledBitstreamCompressByCount::generateDoBlockMethod(KernelBuilder & b)
 
 void SwizzledBitstreamCompressByCount::generateFinalBlockMethod(KernelBuilder & b, Value * /* remainingBytes */) {
     RepeatDoBlockLogic(b);
-    Constant * blockOffsetMask = b.getSize(b.getBitBlockWidth() - 1);
+    Constant * blockOffsetMask = b.getSize(b.getBitBlockWidth() + 1);
     Constant * outputIndexShift = b.getSize(floor_log2(mFieldWidth));
     Type * blockTy = b.getBitBlockType();
 

### MUTANT M63
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..f3b59344 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1356,7 +1356,7 @@ FilterByMaskKernel::FilterByMaskKernel(LLVMTypeSystemInterface & ts,
                    ":" + streamutils::genSignature(inputOps),
 {}, {}, {}, {}, {})
 , mFW(fieldWidth)
-, mFieldsPerBlock(ts.getBitBlockWidth() / fieldWidth)
+, mFieldsPerBlock(ts.getBitBlockWidth() * fieldWidth)
 , mStreamCount(filteredOutput->getNumElements()) {
     mMaskOp.operation = maskOp.operation;
     mMaskOp.bindings.push_back(std::make_pair("extractionMask", maskOp.bindings[0].second));

### MUTANT M64
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..8a3143f2 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1370,7 +1370,7 @@ FilterByMaskKernel::FilterByMaskKernel(LLVMTypeSystemInterface & ts,
     }
     mOutputStreamSets.push_back(Bind("filteredOutput", filteredOutput, PopcountOf("extractionMask"), EmptyWriteOverflow()));
     assert (mOutputStreamSets.back().getDistribution().getTypeId() == insertionProbabilityDistribution.getTypeId());
-    if (mStreamCount >= MIN_STREAMS_TO_SWIZZLE) {
+    if (mStreamCount > MIN_STREAMS_TO_SWIZZLE) {
         mPendingType = ts.getBitBlockType();
         mPendingSetCount = (mStreamCount + mFieldsPerBlock - 1)/mFieldsPerBlock;
     } else {

### MUTANT M65
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..a01f2f91 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1377,7 +1377,7 @@ FilterByMaskKernel::FilterByMaskKernel(LLVMTypeSystemInterface & ts,
         mPendingType = ts.getIntNTy(mFW);
         mPendingSetCount = mStreamCount;
     }
-    for (unsigned i = 0; i < mPendingSetCount; i++) {
+    for (unsigned i = 0; i <= mPendingSetCount; i++) {
         addInternalScalar(mPendingType, "pendingData" + std::to_string(i));
     }
     addInternalScalar(ts.getSizeTy(), "pendingOffset");

### MUTANT M66
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..63ddf5ac 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1386,7 +1386,7 @@ FilterByMaskKernel::FilterByMaskKernel(LLVMTypeSystemInterface & ts,
 
 void FilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & kb, llvm::Value * const numOfStrides) {
     const auto Use_BMI_PEXT = kb.hasFeature(IDISA::Feature::AVX_BMI2);
-    assert ((mStride % kb.getBitBlockWidth()) == 0);
+    assert ((mStride % kb.getBitBlockWidth()) != 0);
     Constant * const sz_BLOCKS_PER_STRIDE = kb.getSize(mStride/kb.getBitBlockWidth());
     Constant * const sz_ZERO = kb.getSize(0);
     Constant * const sz_ONE = kb.getSize(1);

### MUTANT M67
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..4d31bdaa 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1387,7 +1387,7 @@ FilterByMaskKernel::FilterByMaskKernel(LLVMTypeSystemInterface & ts,
 void FilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & kb, llvm::Value * const numOfStrides) {
     const auto Use_BMI_PEXT = kb.hasFeature(IDISA::Feature::AVX_BMI2);
     assert ((mStride % kb.getBitBlockWidth()) == 0);
-    Constant * const sz_BLOCKS_PER_STRIDE = kb.getSize(mStride/kb.getBitBlockWidth());
+    Constant * const sz_BLOCKS_PER_STRIDE = kb.getSize(mStride*kb.getBitBlockWidth());
     Constant * const sz_ZERO = kb.getSize(0);
     Constant * const sz_ONE = kb.getSize(1);
     Type * const sizeTy = kb.getSizeTy();

### MUTANT M68
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..6c04e16d 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1387,7 +1387,7 @@ FilterByMaskKernel::FilterByMaskKernel(LLVMTypeSystemInterface & ts,
 void FilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & kb, llvm::Value * const numOfStrides) {
     const auto Use_BMI_PEXT = kb.hasFeature(IDISA::Feature::AVX_BMI2);
     assert ((mStride % kb.getBitBlockWidth()) == 0);
-    Constant * const sz_BLOCKS_PER_STRIDE = kb.getSize(mStride/kb.getBitBlockWidth());
+    Constant * const sz_BLOCKS_PER_STRIDE = kb.getSize(mStride*kb.getBitBlockWidth());
     Constant * const sz_ZERO = kb.getSize(0);
     Constant * const sz_ONE = kb.getSize(1);
     Type * const sizeTy = kb.getSizeTy();
@@ -1396,7 +1396,7 @@ void FilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & kb, llvm::Value
     Type * blockTy = kb.getBitBlockType();
 
     ConstantInt * const LOG_2_BLOCK_WIDTH = kb.getSize(floor_log2(kb.getBitBlockWidth()));
-    ConstantInt * const BLOCK_WIDTH_MASK = kb.getSize(kb.getBitBlockWidth() - 1);
+    ConstantInt * const BLOCK_WIDTH_MASK = kb.getSize(kb.getBitBlockWidth() + 1);
     ConstantInt * const FIELD_WIDTH = kb.getSize(mFW);
     ConstantInt * const LOG_2_FIELD_WIDTH = kb.getSize(floor_log2(mFW));
     ConstantInt * const FIELD_WIDTH_MASK = kb.getSize(mFW - 1);


### MUTANT M69
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..6264acf4 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1399,7 +1399,7 @@ void FilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & kb, llvm::Value
     ConstantInt * const BLOCK_WIDTH_MASK = kb.getSize(kb.getBitBlockWidth() - 1);
     ConstantInt * const FIELD_WIDTH = kb.getSize(mFW);
     ConstantInt * const LOG_2_FIELD_WIDTH = kb.getSize(floor_log2(mFW));
-    ConstantInt * const FIELD_WIDTH_MASK = kb.getSize(mFW - 1);
+    ConstantInt * const FIELD_WIDTH_MASK = kb.getSize(mFW + 1);
 
     BasicBlock * const entryBlock = kb.GetInsertBlock();
     BasicBlock * const stridePrologue = kb.CreateBasicBlock("stridePrologue");

### MUTANT M70
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..f35ced90 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1516,7 +1516,7 @@ void FilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & kb, llvm::Value
                 Value * const newItems = swizzles[j];
                 // Combine as many of the new items as possible into the pending group.
                 Value * const shiftedItems = kb.CreateShl(swizzles[j], shiftVector);
-                Value * const combinedGroup = kb.CreateOr(pendingData[j], shiftedItems);
+                Value * const combinedGroup = kb.CreateAnd(pendingData[j], shiftedItems);
                 // To avoid an unpredictable branch, always store the combined group, whether full or not.
                 for (unsigned k = 0; k < mFieldsPerBlock; k++) {
                     unsigned strmIdx = j * mFieldsPerBlock + k;

### MUTANT M71
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..12c0f813 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1559,7 +1559,7 @@ void FilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & kb, llvm::Value
     kb.CreateCondBr(kb.CreateAnd(kb.isFinal(), havePendingFieldData), writeFinal, done);
     kb.SetInsertPoint(writeFinal);
     Value * const finalBlock = kb.CreateLShr(producedOffset, LOG_2_BLOCK_WIDTH);
-    Value * const finalField = kb.CreateLShr(kb.CreateAnd(producedOffset, BLOCK_WIDTH_MASK), LOG_2_FIELD_WIDTH);
+    Value * const finalField = kb.CreateLShr(kb.CreateOr(producedOffset, BLOCK_WIDTH_MASK), LOG_2_FIELD_WIDTH);
     if (mStreamCount < MIN_STREAMS_TO_SWIZZLE) {
         for (unsigned j = 0; j < mStreamCount; j++) {
             Value * outputPtr = kb.getOutputStreamBlockPtr("filteredOutput", kb.getInt32(j), finalBlock);

### MUTANT M72
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..ba79cb64 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1598,7 +1598,7 @@ ByteFilterByMaskKernel::ByteFilterByMaskKernel(LLVMTypeSystemInterface & b, Stre
 }(),
 {Binding{"byteStream", byteStream}, Binding{"filter", filter}},
 {Binding{"output", output, PopcountOf("filter"), EmptyWriteOverflow()}}, {}, {}, {}) {
-    assert (byteStream->getFieldWidth() == output->getFieldWidth());
+    assert (byteStream->getFieldWidth() != output->getFieldWidth());
     if (streamOffset) {
         mInputScalars.emplace_back("offset", streamOffset);
     }

### MUTANT M73
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..bd05785a 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1615,7 +1615,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
     const auto fieldWidth = getInputStreamSet(0)->getFieldWidth();
 
     StreamSet * const output = getOutputStreamSet(0);
-    if (LLVM_UNLIKELY(output->getFieldWidth() != fieldWidth)) {
+    if (LLVM_UNLIKELY(output->getFieldWidth() == fieldWidth)) {
         report_fatal_error(Twine{getName(), ": input field width does not match output field width"});
     }
 

### MUTANT M74
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..55d89e2d 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1625,7 +1625,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
         report_fatal_error(Twine{getName(), ": number of output streams exceeds the input streamset size"});
     }
 
-    const auto fieldsPerBlock = (b.getBitBlockWidth() / fieldWidth);
+    const auto fieldsPerBlock = (b.getBitBlockWidth() * fieldWidth);
 
     ConstantInt * const BLOCK_WIDTH_MASK = b.getSize(b.getBitBlockWidth() - 1);
 

### MUTANT M75
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..b9a20da7 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1627,7 +1627,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
 
     const auto fieldsPerBlock = (b.getBitBlockWidth() / fieldWidth);
 
-    ConstantInt * const BLOCK_WIDTH_MASK = b.getSize(b.getBitBlockWidth() - 1);
+    ConstantInt * const BLOCK_WIDTH_MASK = b.getSize(b.getBitBlockWidth() + 1);
 
     ConstantInt * const FIELD_WIDTH_MASK = b.getSize(fieldWidth - 1);
 

### MUTANT M76
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..842d62b5 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1629,7 +1629,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
 
     ConstantInt * const BLOCK_WIDTH_MASK = b.getSize(b.getBitBlockWidth() - 1);
 
-    ConstantInt * const FIELD_WIDTH_MASK = b.getSize(fieldWidth - 1);
+    ConstantInt * const FIELD_WIDTH_MASK = b.getSize(fieldWidth + 1);
 
     ConstantInt * const LOG_2_FIELD_WIDTH = b.getSize(floor_log2(fieldWidth));
 

### MUTANT M77
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..430e3d9e 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1627,7 +1627,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
 
     const auto fieldsPerBlock = (b.getBitBlockWidth() / fieldWidth);
 
-    ConstantInt * const BLOCK_WIDTH_MASK = b.getSize(b.getBitBlockWidth() - 1);
+    ConstantInt * const BLOCK_WIDTH_MASK = b.getSize(b.getBitBlockWidth() - 2);
 
     ConstantInt * const FIELD_WIDTH_MASK = b.getSize(fieldWidth - 1);
 

### MUTANT M78
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..1102f45a 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1635,7 +1635,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
 
     ConstantInt * const FIELDS_PER_BLOCK = b.getSize(fieldsPerBlock);
 
-    ConstantInt * const FIELDS_PER_BLOCK_MASK = b.getSize(fieldsPerBlock - 1);
+    ConstantInt * const FIELDS_PER_BLOCK_MASK = b.getSize(fieldsPerBlock - 2);
 
     ConstantInt * const LOG_2_FIELDS_PER_BLOCK = b.getSize(floor_log2(fieldsPerBlock));
 

### MUTANT M79
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..a039ebc6 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1643,7 +1643,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
 
     Value * initToWritePos = b.getProducedItemCount("output");
 
-    if (numInputElements == 1) {
+    if (numInputElements != 1) {
 
         assert (numOutputElements == 1);
 

### MUTANT M80
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..82d7ca69 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1645,7 +1645,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
 
     if (numInputElements == 1) {
 
-        assert (numOutputElements == 1);
+        assert (numOutputElements != 1);
 
         Value * const totalBlocks = b.CreateMul(numOfStrides, b.getSize(fieldWidth));
         Value * const baseDataPtr = b.getInputStreamPackPtr("byteStream", sz_ZERO, sz_ZERO);

### MUTANT M81
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..351c23df 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1649,7 +1649,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
 
         Value * const totalBlocks = b.CreateMul(numOfStrides, b.getSize(fieldWidth));
         Value * const baseDataPtr = b.getInputStreamPackPtr("byteStream", sz_ZERO, sz_ZERO);
-        assert (fieldWidth <= b.getBitBlockWidth());
+        assert (fieldWidth < b.getBitBlockWidth());
         const auto popCountSize = b.getBitBlockWidth() / fieldWidth;
 
         Value * const baseFilterPtr = b.getInputStreamPackPtr("filter", sz_ZERO, sz_ZERO);

### MUTANT M82
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..fbe740d2 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1650,7 +1650,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
         Value * const totalBlocks = b.CreateMul(numOfStrides, b.getSize(fieldWidth));
         Value * const baseDataPtr = b.getInputStreamPackPtr("byteStream", sz_ZERO, sz_ZERO);
         assert (fieldWidth <= b.getBitBlockWidth());
-        const auto popCountSize = b.getBitBlockWidth() / fieldWidth;
+        const auto popCountSize = b.getBitBlockWidth() * fieldWidth;
 
         Value * const baseFilterPtr = b.getInputStreamPackPtr("filter", sz_ZERO, sz_ZERO);
 

### MUTANT M83
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..d9c8b2ac 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1665,7 +1665,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
         Value * filter = nullptr;
         if (popCountSize < 8) {
             Value * ptr = b.CreatePointerCast(baseFilterPtr, b.getInt8Ty()->getPointerTo());
-            const auto packsPerByte = (8 / popCountSize);
+            const auto packsPerByte = (8 * popCountSize);
             assert (packsPerByte > 1);
             Value * pos = b.CreateLShr(blockOffsetPhi, b.getSize(floor_log2(packsPerByte)));
             filter = b.CreateAlignedLoad(b.getInt8Ty(), b.CreateGEP(b.getInt8Ty(), ptr, pos), 1);

### MUTANT M84
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..173849ed 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1666,7 +1666,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
         if (popCountSize < 8) {
             Value * ptr = b.CreatePointerCast(baseFilterPtr, b.getInt8Ty()->getPointerTo());
             const auto packsPerByte = (8 / popCountSize);
-            assert (packsPerByte > 1);
+            assert (packsPerByte >= 1);
             Value * pos = b.CreateLShr(blockOffsetPhi, b.getSize(floor_log2(packsPerByte)));
             filter = b.CreateAlignedLoad(b.getInt8Ty(), b.CreateGEP(b.getInt8Ty(), ptr, pos), 1);
             filter = b.CreateZExt(filter, b.getSizeTy());

### MUTANT M85
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..dafadb89 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1670,7 +1670,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
             Value * pos = b.CreateLShr(blockOffsetPhi, b.getSize(floor_log2(packsPerByte)));
             filter = b.CreateAlignedLoad(b.getInt8Ty(), b.CreateGEP(b.getInt8Ty(), ptr, pos), 1);
             filter = b.CreateZExt(filter, b.getSizeTy());
-            Value * off = b.CreateAnd(blockOffsetPhi, b.getSize(packsPerByte - 1));
+            Value * off = b.CreateAnd(blockOffsetPhi, b.getSize(packsPerByte + 1));
             filter = b.CreateLShr(filter, b.CreateShl(off, b.getSize(floor_log2(popCountSize))));
             filter = b.CreateAnd(filter, b.getSize((1UL << popCountSize) - 1UL));
         } else {

### MUTANT M86
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..0b1fe8c4 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1672,7 +1672,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
             filter = b.CreateZExt(filter, b.getSizeTy());
             Value * off = b.CreateAnd(blockOffsetPhi, b.getSize(packsPerByte - 1));
             filter = b.CreateLShr(filter, b.CreateShl(off, b.getSize(floor_log2(popCountSize))));
-            filter = b.CreateAnd(filter, b.getSize((1UL << popCountSize) - 1UL));
+            filter = b.CreateAnd(filter, b.getSize((1UL >> popCountSize) - 1UL));
         } else {
             IntegerType * const popCountTy = b.getIntNTy(popCountSize);
             Value * ptr = b.CreatePointerCast(baseFilterPtr, popCountTy->getPointerTo());

### MUTANT M87
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..dc67138b 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1672,7 +1672,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
             filter = b.CreateZExt(filter, b.getSizeTy());
             Value * off = b.CreateAnd(blockOffsetPhi, b.getSize(packsPerByte - 1));
             filter = b.CreateLShr(filter, b.CreateShl(off, b.getSize(floor_log2(popCountSize))));
-            filter = b.CreateAnd(filter, b.getSize((1UL << popCountSize) - 1UL));
+            filter = b.CreateAnd(filter, b.getSize((1UL << popCountSize) + 1UL));
         } else {
             IntegerType * const popCountTy = b.getIntNTy(popCountSize);
             Value * ptr = b.CreatePointerCast(baseFilterPtr, popCountTy->getPointerTo());

### MUTANT M88
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..4f175bb3 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1676,7 +1676,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
         } else {
             IntegerType * const popCountTy = b.getIntNTy(popCountSize);
             Value * ptr = b.CreatePointerCast(baseFilterPtr, popCountTy->getPointerTo());
-            filter = b.CreateAlignedLoad(popCountTy, b.CreateGEP(popCountTy, ptr, blockOffsetPhi), popCountSize / 8);
+            filter = b.CreateAlignedLoad(popCountTy, b.CreateGEP(popCountTy, ptr, blockOffsetPhi), popCountSize * 8);
         }
 
         Value * const data = b.CreateAlignedLoad(dataVecTy, b.CreateGEP(dataVecTy, baseDataPtr, blockOffsetPhi), b.getBitBlockWidth() / 8);

### MUTANT M89
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..c5f519d1 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1719,7 +1719,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
         for (unsigned i = 0; i < numOutputElements; ++i) {
             Value * streamIndex = b.getSize(i);
             Value * ptr = b.getOutputStreamPackPtr("output", streamIndex, initialPackIndex, sz_ZERO);
-            pending[i] = b.CreateAlignedLoad(dataVecTy, ptr, b.getBitBlockWidth() / 8);
+            pending[i] = b.CreateAlignedLoad(dataVecTy, ptr, b.getBitBlockWidth() * 8);
         }
 
         b.CreateBr(packLoop);

### MUTANT M90
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..7b60eb9f 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1708,7 +1708,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
             }
         }
 
-        Value * initialPosition = b.CreateAnd(initToWritePos, BLOCK_WIDTH_MASK);
+        Value * initialPosition = b.CreateOr(initToWritePos, BLOCK_WIDTH_MASK);
         Value * initialPackIndex = b.CreateLShr(initialPosition, LOG_2_FIELDS_PER_BLOCK);
 
         SmallVector<Value *, 32> pending(numOutputElements);

### MUTANT M91
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..fe970d57 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1709,7 +1709,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
         }
 
         Value * initialPosition = b.CreateAnd(initToWritePos, BLOCK_WIDTH_MASK);
-        Value * initialPackIndex = b.CreateLShr(initialPosition, LOG_2_FIELDS_PER_BLOCK);
+        Value * initialPackIndex = b.CreateRShr(initialPosition, LOG_2_FIELDS_PER_BLOCK);
 
         SmallVector<Value *, 32> pending(numOutputElements);
         SmallVector<PHINode *, 32> pendingPhi(numOutputElements);

### MUTANT M92
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..55d444ee 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1773,7 +1773,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
                 if (i == 0) {
                     filterElem[j] = b.CreateExtractElement(filterVec, b.getInt32(j));
                     Value * const elementPopCount = b.CreateZExt(b.CreatePopcount(filterElem[j]), b.getSizeTy());
-                    leftShift[j] = b.CreateAnd(shiftVal[j], FIELDS_PER_BLOCK_MASK);
+                    leftShift[j] = b.CreateOr(shiftVal[j], FIELDS_PER_BLOCK_MASK);
                     packIndex[j] = b.CreateAnd(fieldPackIndex[j], FIELD_WIDTH_MASK);
                     blockIndex[j] = b.CreateLShr(fieldPackIndex[j], LOG_2_FIELD_WIDTH);
                     rightShift[j] = b.CreateSub(FIELDS_PER_BLOCK, leftShift[j]);

### MUTANT M93
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..1ecfced8 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1774,7 +1774,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
                     filterElem[j] = b.CreateExtractElement(filterVec, b.getInt32(j));
                     Value * const elementPopCount = b.CreateZExt(b.CreatePopcount(filterElem[j]), b.getSizeTy());
                     leftShift[j] = b.CreateAnd(shiftVal[j], FIELDS_PER_BLOCK_MASK);
-                    packIndex[j] = b.CreateAnd(fieldPackIndex[j], FIELD_WIDTH_MASK);
+                    packIndex[j] = b.CreateOr(fieldPackIndex[j], FIELD_WIDTH_MASK);
                     blockIndex[j] = b.CreateLShr(fieldPackIndex[j], LOG_2_FIELD_WIDTH);
                     rightShift[j] = b.CreateSub(FIELDS_PER_BLOCK, leftShift[j]);
                     Value * nextShiftVal = b.CreateAdd(shiftVal[j], elementPopCount);

### MUTANT M94
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..59537806 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1775,7 +1775,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
                     Value * const elementPopCount = b.CreateZExt(b.CreatePopcount(filterElem[j]), b.getSizeTy());
                     leftShift[j] = b.CreateAnd(shiftVal[j], FIELDS_PER_BLOCK_MASK);
                     packIndex[j] = b.CreateAnd(fieldPackIndex[j], FIELD_WIDTH_MASK);
-                    blockIndex[j] = b.CreateLShr(fieldPackIndex[j], LOG_2_FIELD_WIDTH);
+                    blockIndex[j] = b.CreateRShr(fieldPackIndex[j], LOG_2_FIELD_WIDTH);
                     rightShift[j] = b.CreateSub(FIELDS_PER_BLOCK, leftShift[j]);
                     Value * nextShiftVal = b.CreateAdd(shiftVal[j], elementPopCount);
                     Value * nextPackIndex = b.CreateLShr(nextShiftVal, LOG_2_FIELDS_PER_BLOCK);

### MUTANT M95
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..7905145d 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1778,7 +1778,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
                     blockIndex[j] = b.CreateLShr(fieldPackIndex[j], LOG_2_FIELD_WIDTH);
                     rightShift[j] = b.CreateSub(FIELDS_PER_BLOCK, leftShift[j]);
                     Value * nextShiftVal = b.CreateAdd(shiftVal[j], elementPopCount);
-                    Value * nextPackIndex = b.CreateLShr(nextShiftVal, LOG_2_FIELDS_PER_BLOCK);
+                    Value * nextPackIndex = b.CreateRShr(nextShiftVal, LOG_2_FIELDS_PER_BLOCK);
                     keepCurrentPending[j] = b.CreateICmpEQ(fieldPackIndex[j], nextPackIndex);
                     fieldPackIndex[j + 1] = nextPackIndex;
                     shiftVal[j + 1] = nextShiftVal;

### MUTANT M96
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..f65d5aa2 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1786,7 +1786,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
                 Value * const data = b.loadInputStreamPack("byteStream", inputStreamIndex, b.getSize(j), blockOffsetPhi);
                 Value * const compressed = b.mvmd_compress(fieldWidth, data, filterElem[j]);
                 Value * lshiftVal = b.mvmd_sll(fieldWidth, compressed, leftShift[j]);
-                Value * toWriteVal = b.CreateOr(pending[i], lshiftVal);
+                Value * toWriteVal = b.CreateAnd(pending[i], lshiftVal);
                 b.storeOutputStreamPack("output", outputStreamIndex, packIndex[j], blockIndex[j], toWriteVal);
                 Value * rshiftVal = b.mvmd_srl(fieldWidth, compressed, rightShift[j]);
                 rshiftVal = b.CreateSelect(b.CreateICmpNE(leftShift[j], sz_ZERO), rshiftVal, ZERO_VEC);

### MUTANT M97
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..952c9d1e 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1810,7 +1810,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
         b.CreateCondBr(moreToDo, packLoop, packFinalize);
 
         b.SetInsertPoint(packFinalize);
-        Value * packIdx = b.CreateAnd(fieldPackIndex[fieldWidth], FIELD_WIDTH_MASK);
+        Value * packIdx = b.CreateOr(fieldPackIndex[fieldWidth], FIELD_WIDTH_MASK);
         Value * blkIdx = b.CreateLShr(fieldPackIndex[fieldWidth], LOG_2_FIELD_WIDTH);
         for (unsigned i = 0; i < numOutputElements; ++i) {
             b.storeOutputStreamPack("output", b.getSize(i), packIdx, blkIdx, pending[i]);

### MUTANT M98
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..c32f1287 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -1811,7 +1811,7 @@ void ByteFilterByMaskKernel::generateMultiBlockLogic(KernelBuilder & b, Value *
 
         b.SetInsertPoint(packFinalize);
         Value * packIdx = b.CreateAnd(fieldPackIndex[fieldWidth], FIELD_WIDTH_MASK);
-        Value * blkIdx = b.CreateLShr(fieldPackIndex[fieldWidth], LOG_2_FIELD_WIDTH);
+        Value * blkIdx = b.CreateRShr(fieldPackIndex[fieldWidth], LOG_2_FIELD_WIDTH);
         for (unsigned i = 0; i < numOutputElements; ++i) {
             b.storeOutputStreamPack("output", b.getSize(i), packIdx, blkIdx, pending[i]);
         }

### MUTANT M99
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..496490bf 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -222,7 +222,7 @@ void DeletionKernel::generateFinalBlockMethod(KernelBuilder & b, Value * remaini
     IntegerType * vecTy = b.getIntNTy(b.getBitBlockWidth());
     Value * remaining = b.CreateZExt(remainingBytes, vecTy);
     Value * EOF_del = b.bitCast(b.CreateShl(Constant::getAllOnesValue(vecTy), remaining));
-    Value * delMask = b.CreateOr(EOF_del, b.loadInputStreamBlock("delMaskSet", b.getInt32(0)));
+    Value * delMask = b.CreateAnd(EOF_del, b.loadInputStreamBlock("delMaskSet", b.getInt32(0)));
     const auto move_masks = parallel_prefix_deletion_masks(b, mDeletionFieldWidth, delMask);
     for (unsigned j = 0; j < mStreamCount; ++j) {
         Value * input = b.loadInputStreamBlock("inputStreamSet", b.getInt32(j));

### MUTANT M100
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..be947ec4 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -420,7 +420,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
     }
 
     Value * const produced = b.getProducedItemCount("compressedOutput");
-    Value * const pendingItemCount = b.CreateAnd(b.CreateZExtOrTrunc(produced, fwTy), BLOCK_MASK);
+    Value * const pendingItemCount = b.CreateOr(b.CreateZExtOrTrunc(produced, fwTy), BLOCK_MASK);
 
     // TODO: we could make this kernel stateless but would have to use "bitblock_mask_to" on the
     // input to account for the fact the pipeline doesn't zero out output stream data when it

### MUTANT M101
diff --git a/lib/kernel/streamutils/deletion.cpp b/lib/kernel/streamutils/deletion.cpp
index cdb27d1f..1a553ceb 100644
--- a/lib/kernel/streamutils/deletion.cpp
+++ b/lib/kernel/streamutils/deletion.cpp
@@ -727,7 +727,7 @@ void StreamCompressKernel::generateMultiBlockLogic(KernelBuilder & b, llvm::Valu
 
     Value * const hasAnyBit = b.CreateZExt(b.bitblock_any(pendingMask), sizeTy);
     Value * const maskBit = b.CreateShl(hasAnyBit, maskOffsetPhi);
-    Value * const iteratorMask = b.CreateOr(iteratorMaskPhi, maskBit);
+    Value * const iteratorMask = b.CreateAnd(iteratorMaskPhi, maskBit);
 
     Value * const nextMaskOffset = b.CreateAdd(maskOffsetPhi, sz_ONE);
     maskOffsetPhi->addIncoming(nextMaskOffset, buildIteratorMask);
